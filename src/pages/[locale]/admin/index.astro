---
import AdminLayout from "../../../layouts/AdminLayout.astro";
import { Icon } from "astro-icon/components";
import { t, locales, defaultLocale } from "../../../i18n/index.ts";
import { db } from "../../../db/index.ts";
import { getMenuItems } from "../../../lib/menu.ts";

const locale = Astro.params.locale ?? defaultLocale;
if (!locales.includes(locale as "en" | "es" | "pt-br")) {
  return Astro.redirect(`/${defaultLocale}/admin`);
}

const user = Astro.locals.user;

if (!user) {
  return Astro.redirect("/login");
}

const menuItems = await getMenuItems(db);
---

<AdminLayout title={t(locale, "admin.menu.dashboard")} locale={locale} menuItems={menuItems} user={user}>

  <div class="p-6 max-w-4xl">
    <div class="card bg-base-100 shadow">
      <div class="card-body">
        <h2 class="card-title">{t(locale, "admin.welcome.title")}</h2>
        <p>{t(locale, "admin.welcome.authenticatedAs", { name: user.name ?? user.email })}</p>
      </div>
    </div>
  </div>
</AdminLayout>
